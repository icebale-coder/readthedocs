title: nmcli
# **NetworkManager (nmcli)**

**nmcli** это инструмент командной строки, с помощью которого можно контролировать NetworkManager и следить за статусом сети.

Он предназначен для создания, отображения, редактирования, удаления, активирования или деактивирования сетевых соединений, а также для контроля и просмотра статуса сетевых устройств.

## Установка

=== "Debian (apt)"

	`apt install network-manager` - установка произведётся автоматически. Сам пакет и его зависимости присутствуют в стандартных Debian репозиториях.
	
	Вместе с ним будет установлен nmtui - графическая оболочка для него.

=== "CentOS (yum)"

	`yum install ...` 
	
	!!! warning "FIXME"

## Базовые команды

### general

**`nmcli general`** { **status** | **hostname** | **permissions** | **logging** } [*`ARGUMENTS`*...]

Эта команда используется для отображения статуса и разрешений NetworkManager. С её помощью также можно получать и изменять hostname системы, уровень логирования NetworkManager.

* **``status``** - показывает общий статус NetworkManager.

* **``hostname``** [*`hostname`*] - вывести или изменить hostname системы. Без агрументов эта команда выводит текущий hostname. Если в качестве аргументов передать ему слово, команда установит его как новый hostname.

* **``permissions``** - показывает разрешения NetworkManager на проведение разных операций, вроде включение или выключения сети, изменения сетевых соединений и т.п.

* **``logging``** [`level` *`level`*] [`domains` *`domains`*...] - вывести или изменить уровни логирования и домены NetworkManager.

### networking

**`nmcli networking`** { **on** | **off** | **connectivity** } [*`ARGUMENTS`*...]

* **``on``**, **``off``** - включить или выключить контроль сети NetworkManager'ом. Все интерфейсы, управляемые NetworkManager'ом, отключаются при выключении NetworkManager.
* **``connectivity``** [`check`] - вывести текущую связность этой машины. Опциональный атрибут `check` говорит NetworkManager перепроверить статус связности. В ином случае, будет выводится не текущий статус, а статус при последней проверке. Возможные статусы:
  * `none` - машина не подключена ни к какой сети
  * `portal` - машина находится за captive portal и не может полностью достичь Интернета.
  * `limited` - машина подклюена к сети, но у неё нет доступа к Интернету.
  * `full` - машина подключена к сети, у неёё есть доступ к Интернету.
  * `unknown` - статус связности не может быть определён

### radio

!!! warning "FIXME"

### monitor

**`nmcli monitor`**

Наблюдение за изменение в статусе связности, устройств или переключений.

## Изменение сетевых настроек на интерфейсах

### Connection

**`nmcli connection`** { **show** | **up** | **down** | **modify** | **add** | **edit** | **clone** | **delete** | **monitor** | **reload** | **load** | **import** | **export** } [*`ARGUMENTS`*...]

* **`status`** - отобразить статус устройств.

* **`show`** [*`ifname`*] - отобразить детальную информацию об устройствах.

* **`set`** [`ifname`] *`ifname`* [ `autoconnect` { yes | no } ] [ `managed` { yes | no } ] - установка параметров устройства.

* **`connect`** *`ifname`* - подключить устройство. NetworkManager попытается определить подходящее подключение, которое будет активировано. Если не были обнаружены совместимые соединения, будет создан и активирован стандартный профиль.

* **`modify`** *`ifname`* { *`option`* *`value`* | [+|-]*`setting`*.*`property`* *`value`* } ... - изменить текущие настройки на устройстве. Эти изменения не сохраняются в профиле устройства. 

* **``disconnect``** *`ifname`*... - отключить устройство и предотвратить автоматическую активацию их без пользовательского вмешательства.

* **`delete`** *`ifname`*... - удаляет интерфейс из системы. Обратите внимание, что это работает только с программными устройствами, типа bond, bridge.

* **`monitor`** [*`ifname`*...] - мониторинг активности устройства.

* **`reload`** - перезагрузить все файлы соединений из диска. 

* **`load`** *`filename`*... - загрузить/перезагрузить один или более файлов соединений с диска. Это нужно использовать для подгрузки конфигурации устройства после его ручного редактирования.

* **`import`** [`--temporary`] `type` *`type`* `file` *`file `* - 

!!! warning "FIXME"

* **`export`** [ `id` | `uuid` | `path` ] *`ID`* [*`file`*]

!!! warning "FIXME"

### Device

**`nmcli device`** { **status** | **show** | **set** | **connect** | **reapply** | **modify** | **disconnect** | **delete** | **monitor** | **wifi** | **lldp** } [*`ARGUMENTS`*...]

!!! warning "FIXME"

## nmtui - текстовый интерфейс

**nmtui** является текстовым интерфейсов для NetworkManager. В нём реализован основной функционал, такой как:

* создание/изменение/удаление connection profiles, т.е. назначение/изменение адресации

* изменение hostname устройства

![image-20200817132644290](C:\Users\ct7lh1\AppData\Roaming\Typora\typora-user-images\image-20200817132644290.png)

## Дополнительно

##### man'ы

- [nmcli](*/linux/man/nmcli)
- [nmcli-examples](*/linux/man/nmcli-examples)

##### Связанные материалы


##### Литература

- [GNOME developer nmcli docs](https://developer.gnome.org/NetworkManager/stable/nmcli.html)
...